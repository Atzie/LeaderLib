Version 1
SubGoalCombiner SGC_AND
INITSECTION
LLLIB_LeaderTrader_RegisterTrader();
KBSECTION
//REGION REGISTER
PROC
LLLIB_LeaderTrader_RegisterTrader()
THEN
LLLIB_Trader_Register_GlobalTrader("LLLIB_LeaderTrader", CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41);
LLLIB_Trader_Register_Level("LLLIB_LeaderTrader", "TUT_Tutorial_A");
LLLIB_Trader_Register_Position("LLLIB_LeaderTrader", "TUT_Tutorial_A", 31.19, 4.0, -252.77);

LLLIB_Trader_Register_Level("LLLIB_LeaderTrader", "FJ_FortJoy_Main");
LLLIB_Trader_Register_Position("LLLIB_LeaderTrader", "FJ_FortJoy_Main", 219.86, -16.79, 362.70);

LLLIB_LeaderTrader_RegisterDeckSeat("LeaderLib_TestLevel", ITEMGUID_LLLIB_DebugLevel_TraderChair_8468a5fd-00a4-42c2-aa15-1b1a25e46738);

LLLIB_LeaderTrader_RegisterDeckSeat("LV_HoE_Main", ITEMGUID_FUR_Humans_Citz_Stool_C_005_a2a11ad5-645b-4719-bfd5-be04f32fbb2a);
LLLIB_LeaderTrader_RegisterDeckSeat("RC_Main", ITEMGUID_FUR_Humans_Citz_Stool_C_005_a2a11ad5-645b-4719-bfd5-be04f32fbb2a);
LLLIB_LeaderTrader_RegisterDeckSeat("CoS_Main", ITEMGUID_FUR_Humans_Citz_Stool_C_005_a2a11ad5-645b-4719-bfd5-be04f32fbb2a);
LLLIB_LeaderTrader_RegisterDeckSeat("Arx_Main", ITEMGUID_FUR_Humans_Citz_Stool_C_005_a2a11ad5-645b-4719-bfd5-be04f32fbb2a);

PROC
LLLIB_LeaderTrader_RegisterDeckSeat((STRING)_LevelName, (ITEMGUID)_Seat)
THEN
LLLIB_Trader_Register_Level("LLLIB_LeaderTrader", _LevelName);
LLLIB_Trader_Register_PositionObject("LLLIB_LeaderTrader", _LevelName, (GUIDSTRING)_Seat);
LLLIB_Trader_Register_Seat("LLLIB_LeaderTrader", _LevelName, (ITEMGUID)_Seat);
//END_REGION

//REGION AVOID_COMBAT
IF
CombatStarted(_CombatID)
AND
CharacterIsInCombat(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, 1)
AND
CombatGetIDForCharacter(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, _CombatID)
THEN
DB_LLLIB_LeaderTrader_AvoidingCombat(_CombatID);
DisplayText(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, "I'm retired from the chaos of battle! No more I say!");
CharacterUseSkill(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, "Shout_ChameleonSkin", CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, 0, 1, 1);

IF
CharacterStatusApplied(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, "INVISIBLE", _)
THEN
SetOnStage(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, 0);

IF
CombatEnded(_CombatID)
AND
DB_LLLIB_LeaderTrader_AvoidingCombat(_CombatID)
THEN
TimerLaunch("LLLIB_Timers_LeaderTrader_CombatEnded", 3000);
NOT DB_LLLIB_LeaderTrader_AvoidingCombat(_CombatID);

IF
TimerFinished("LLLIB_Timers_LeaderTrader_CombatEnded")
THEN
SetOnStage(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, 1);
ApplyStatus(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, "INVISIBLE", 6.0, 1);

IF
CharacterStatusRemoved(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, "Invisible", _)
THEN
DisplayText(CHARACTERGUID_S_LLLIB_LeaderTrader_b15c8e24-0de0-4ab2-940d-751bf95f0f41, "Hrmph...");
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LaughingLeader__LeaderLib"
